<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>부퀘스트 – 테스트 페이지</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif; margin: 0; background: #f7f7fb; color: #111827; }
    header { padding: 20px; text-align: center; background: linear-gradient(to bottom, #2A7BFF, #57BAFF); border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; z-index: 10; color: #ffffff; }
    header h1 { margin: 0 0 6px; font-size: 20px; }
    header p { margin: 0; font-size: 13px; color: #f4f4f4; }
    main { max-width: 860px; margin: 24px auto; padding: 0 16px 48px; }
    #resultImage {width: 200px; height: auto; }

    .card { background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 24px; box-shadow: 0 6px 20px rgba(17,24,39,0.04); }
    .question { font-size: 22px; font-weight: 700; line-height: 1.35; margin-bottom: 16px; }

    .answers { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 12px; }
    .answer-btn { appearance: none; border: 1px solid #e5e7eb; background: #fff; padding: 14px 16px; border-radius: 12px; text-align: left; font-size: 16px; cursor: pointer; transition: transform .02s ease, box-shadow .2s ease, border-color .2s ease; }
    .answer-btn:hover { box-shadow: 0 8px 24px rgba(17,24,39,0.06); border-color: #d1d5db; }
    .answer-btn:active { transform: translateY(1px); }
    .highlight-text { font-weight: 700; font-size: 20px; color: #111827; }


    .toolbar { display: flex; gap: 8px; margin-top: 18px; }
    .tool-btn { border: none; background: #2A7BFF; color: #ffffff; padding: 12px 16px; border-radius: 10px; font-size: 15px; font-weight: 500; cursor: pointer; transition: background 0.2s ease; min-width:120px;}

    .progress-wrap { margin-bottom: 16px; }
    .progress { height: 8px; background: #f3f4f6; border-radius: 999px; overflow: hidden; }
    .bar { height: 100%; width: 0; background: #111827; transition: width .3s ease; }
    .progress-text { font-size: 12px; color: #6b7280; margin-top: 6px; text-align: right; }

    .result { text-align: center; }
    .result h2 { font-size: 26px; margin: 0 0 8px; }
    .result p { color: #374151; font-size: 16px; line-height: 1.7; }
    .result img { max-width: 100%; height: auto; border-radius: 16px; border: 1px solid #e5e7eb; margin: 14px 0 8px; }

    .notice { font-size: 12px; color: #6b7280; margin-top: 8px; }
    .hidden { display: none !important; }
  </style>
  <!-- Kakao SDK: JavaScript 키로 교체 필요 -->
  <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>

  <style>
    /* 공유 모달 */
    .share-modal {
      position: fixed; inset: 0;
      background: rgba(0,0,0,.38);
      display: flex; align-items: center; justify-content: center;
    }
    .share-card {
      background: #fff; border: 1px solid #e5e7eb; border-radius: 12px;
      padding: 16px; width: 320px; max-width: calc(100% - 32px);
      box-shadow: 0 10px 30px rgba(0,0,0,.15);
    }
    .share-card h3 { margin: 0 0 10px; font-size: 16px; }
    .share-buttons { display: grid; gap: 8px; }

    /* 상세 페이지 텍스트(큰 글씨) */
    .details-wrap { text-align:center; }
    .details-wrap .big { font-size: 24px; font-weight: 800; line-height: 1.5; }
    @media (min-width: 640px){ .details-wrap .big { font-size: 28px; } }

   /* 공용 CTA 버튼 */
    .cta-btn { display:inline-block; padding:12px 16px; border-radius:10px;
      border:1px solid #111827; text-decoration:none; }

      /* 다운로드 모달 전용 카드 */
      .download-card {
        width: 280px;   
        text-align: center;  
      }
      .download-card .tool-btn {
        display: block;
        text-align: center;
      }

      #downloadModal .tool-btn { text-decoration: none; font-weight: 700; }

      #shareCloseBtn,
      #downloadCloseBtn {
        background: #ffffff;   
        color: #111827;        
        border: 1px solid #e5e7eb; 
        font-weight: 350 !important;   
      }

      #shareCloseBtn:hover,
      #downloadCloseBtn:hover {
        background: #f9fafb;  
      }

      #backBtn,
      #restartBtn {
        background: #f3f4f6;   
        color: #111827; border: 1px solid #d1d5db; 
        font-size: 13px;       
        font-weight: 500;      
        padding: 9px 13px;    
      }

      #backBtn:hover,
      #restartBtn:hover {
        background: #e5e7eb;   
      }
  </style>

</head>
<body>
  <header>
    <h1>당신의 크리에이터 유형은?</h1>
    <p>1분만에 당신의 SNS 부업 유형을 파악해보세요</p>
  </header>

  <main>
    <div class="card">
      <div class="progress-wrap">
        <div class="progress"><div class="bar" id="progressBar"></div></div>
        <div class="progress-text" id="progressText">진행도 0%</div>
      </div>

      <!-- 표지 화면 -->
      <div id="screen-cover" class="screen">
        <div style="text-align:center;">
          <h2>당신의 크리에이터 유형은?</h2>
          <p>1분만에 당신의 SNS 부업 유형을 파악해보세요</p>
          <img src="images/first.jpg" alt="부냥이" style="max-width:230px; margin:16px auto; display:block;">
          <button class="tool-btn" onclick="goNext('intro')" style="display:block; margin:12px auto 0;">
            시작하기
          </button>

        </div>
      </div>

      <!-- 상황설명 화면 -->
      <div id="screen-intro" class="screen hidden">
        <div style="text-align:center;">
          <p style="font-weight:600;">당신은 100명의 관객이 참여하는 무대의 제작자입니다.</p>
          <img src="images/show.jpg" alt="부냥이 망토" 
              style="max-width:200px; height:250px; margin:16px auto; display:block;">
          <button class="tool-btn" onclick="goNext('q1')" 
                style="display:block; margin:12px auto 0;">
            다음
          </button>
        </div>
      </div>

      <!-- 질문 화면 -->
      <div id="screen-question" class="screen hidden">
        <div class="question" id="questionText"></div>
        <div class="answers" id="answers"></div>
        <div class="toolbar">
          <button class="tool-btn" id="backBtn" aria-label="이전으로">← 뒤로가기</button>
          <button class="tool-btn" id="restartBtn" aria-label="처음부터">↻ 처음부터</button>
        </div>
      </div>

      <!-- 결과 화면 -->
      <div id="screen-result" class="screen hidden">
        <div class="result">
          <h2 id="resultTitle">결과 제목</h2>
          <img id="resultImage" alt="결과 이미지" />
          <p id="resultText">결과 설명</p>
          <div class="toolbar" style="justify-content:center; gap:8px;">
            <button class="tool-btn" id="shareBtn">친구에게 공유하기</button>
            <button class="tool-btn" id="moreBtn">더 정확한 추천</button>
          </div>
        </div>
      </div>
    </div>
  </main>
  <div id="shareModal" class="share-modal hidden" role="dialog" aria-modal="true">
    <div class="share-card">
      <div class="share-buttons">
        <button class="tool-btn" id="kakaoShareBtn">카카오톡으로 공유</button>
        <button class="tool-btn" id="instaShareBtn">다른 앱으로 공유</button>
        <button class="tool-btn" id="linkCopyBtn">링크 복사</button>
        <button class="tool-btn" id="shareCloseBtn">닫기</button>
      </div>
    </div>
  </div>

  <div id="downloadModal" class="share-modal hidden" role="dialog" aria-modal="true">
    <div class="share-card download-card">
      <div class="share-buttons">
        <a class="tool-btn" href="https://apps.apple.com/" target="_blank" rel="noopener">앱스토어</a>
        <a class="tool-btn" href="https://play.google.com/store" target="_blank" rel="noopener">플레이스토어</a>
        <button class="tool-btn" id="downloadCloseBtn">닫기</button>
      </div>
    </div>
  </div>

  <script>
    const NODES = {
      "cover": { type: "screen", id: "cover" },
      "intro": { type: "screen", id: "intro" },
      "details": { type: "screen", id: "details" },

      // === Q1 루트 ===
      "q1": {
        type: "question",
        id: "q1",
        text: "100명의 관객을 위한 무대를 준비하는 당신의 역할은?",
        answers: [
          { label: "연출가, 배우", next: "q1-1" },
          { label: "작가", next: "q2-1" },
          { label: "무대 디자이너", next: "q3-1" }
        ]
      },

      // === Q1-1: 연출가 ===
      "q1-1": {
        type: "question",
        id: "q1-1",
        text: "당신이 연출하고 싶은 무대는?",
        answers: [
          { label: "짧은 단막극", next: "q1-1-1" },
          { label: "강연", next: "q1-1-2" },
          { label: "스탠딩 코미디", next: "q1-1-3" },
          { label: "연극", next: "q1-1-4" }
        ]
      },

      // --- 단막극 분기 ---
      "q1-1-1": {
        type: "question",
        id: "q1-1-1",
        text: "당신이 연출한 단막극을 보러온 관객이 옆의 친구에게 하는 말은?",
        answers: [
          { label: "요즘 이게 유행이라는데?", next: "q1-1-1-1" },
          { label: "팜플렛 보니까 재밌어보인다!", next: "q1-1-1-2" },
          { label: "나 이 배우 팬이잖아ㅋㅋ", next: "q1-1-1-3" }
        ]
      },
      "q1-1-1-1": {
        type: "question",
        id: "q1-1-1-1",
        text: "갑작스레 배역에 구멍이 난 상황, 당신이 대타로 출연하게 되었을 때 당신의 반응은?",
        answers: [
          { label: "오히려 좋아~", next: "result-nyangnyong" },
          { label: "차라리 죽을게요", next: "result-jingyeok" }
        ]
      },
      "q1-1-1-2": {
        type: "question",
        id: "q1-1-1-2",
        text: "갑작스레 배역에 구멍이 난 상황, 당신이 대타로 출연하게 되었을 때 당신의 반응은?",
        answers: [
          { label: "오히려 좋아~", next: "result-ppang-ddok" },
          { label: "차라리 죽을게요", next: "result-leejini" }
        ]
      },
      "q1-1-1-3": {
        type: "question",
        id: "q1-1-1-3",
        text: "관객의 성비는?",
        answers: [
          { label: "1:1", next: "result-seunghun" },
          { label: "여성이 더 많음", next: "result-leoj" },
          { label: "남성이 더 많음", next: "result-malwang" }
        ]
      },

      // --- 강연 분기 ---
      "q1-1-2": {
        type: "question",
        id: "q1-1-2",
        text: "당신의 강연에 빠져든 관객이 하는 생각은?",
        answers: [
          { label: "완전 유익하다!", next: "q1-1-2-1" },
          { label: "완전 공감된다!", next: "q1-1-2-2" }
        ]
      },
      "q1-1-2-1": {
        type: "question",
        id: "q1-1-2-1",
        text: "강연을 마친 강사의 목 상태는?",
        answers: [
          { label: "'켈록..! 거기 물 있나요?' 목이 완전히 쉼", next: "result-shuka" },
          { label: "'흠~흠흠~' 아무 이상 없음", next: "result-itsub" }
        ]
      },
      "q1-1-2-2": {
        type: "question",
        id: "q1-1-2-2",
        text: "강연을 듣고 관객이 느낀 쾌감의 종류는?",
        answers: [
          { label: "'크~짜릿해!' 성취의 쾌감", next: "result-ujuhama" },
          { label: "'심장이 두근거려..' 몰입의 쾌감", next: "result-deokyang" }
        ]
      },

      // --- 스탠딩 코미디 분기 ---
      "q1-1-3": {
        type: "question",
        id: "q1-1-3",
        text: "당신의 토크를 경청하는 관객의 태도는?",
        answers: [
          { label: "편하게 기대 앉아서 'ㅋㅋㅋ웃기긴 하네'", next: "q1-1-3-1" },
          { label: "고개를 앞으로 빼고 '오오.. 그런가?'", next: "q1-1-3-2" }
        ]
      },
      "q1-1-3-1": {
        type: "question",
        id: "q1-1-3-1",
        text: "당신이 준비한 회심의 개그는?",
        answers: [
          { label: "4차원스러운 나만의 개그", next: "result-chimchak" },
          { label: "검증된 교과서형 개그", next: "result-mimiminu" }
        ]
      },
      "q1-1-3-2": {
        type: "question",
        id: "q1-1-3-2",
        text: "당신이 준비한 회심의 개그를 들은 관객의 반응은?",
        answers: [
          { label: "이런 예민한 문제도 시원하게 긁어주다니!", next: "result-hongka" },
          { label: "이런 평범한 주제도 재밌게 얘기하다니ㅋㅋ", next: "result-gwedo" }
        ]
      },

      // --- 연극 분기 ---
      "q1-1-4": {
        type: "question",
        id: "q1-1-4",
        text: "당신이 연출한 연극의 종류는?",
        answers: [
          { label: "실화 기반 연극", next: "q1-1-4-1" },
          { label: "창작극", next: "q1-1-4-2" },
          { label: "콩트극", next: "q1-1-4-3" }
        ]
      },
      "q1-1-4-1": {
        type: "question",
        id: "q1-1-4-1",
        text: "연극을 본 관객들의 반응은?",
        answers: [
          { label: "우와 엄청 모험적인 인생을 살았구나!", next: "result-gwak" },
          { label: "평범한 인생인데 왜 이렇게 재밌지?ㅋㅋ", next: "result-mongsun" }
        ]
      },
      "q1-1-4-2": {
        type: "question",
        id: "q1-1-4-2",
        text: "연극을 본 관객들의 반응은?",
        answers: [
          { label: "작가 뇌속에 뭐가 든건지 파헤치고싶다", next: "result-ppangppang" },
          { label: "맞아맞아 공감돼. 나도 저랬지", next: "result-chongmyeot" }
        ]
      },
      "q1-1-4-3": {
        type: "question",
        id: "q1-1-4-3",
        text: "연극을 본 관객의 반응은?",
        answers: [
          { label: "이것도 유행하겠는데?", next: "result-looks" },
          { label: "작가 유행 따라가는 속도 보소ㅋㅋ", next: "result-enjoy" }
        ]
      },

      // === Q2: 작가 ===
      "q2-1": {
        type: "question",
        id: "q2-1",
        text: "무대에서 관객을 더 집중시킨 요소는?",
        answers: [
          { label: "호소력 있는 나레이션", next: "q2-1-1" },
          { label: "눈길을 끄는 장면", next: "q2-2-1" }
        ]
      },
      "q2-1-1": {
        type: "question",
        id: "q2-1-1",
        text: "당신이 작성한 대본의 기반은?",
        answers: [
          { label: "실화 바탕 팩션", next: "q2-1-1-1" },
          { label: "창작 바탕 픽션", next: "q2-1-1-2" }
        ]
      },
      "q2-1-1-1": {
        type: "question",
        id: "q2-1-1-1",
        text: "무대를 본 관객의 반응은?",
        answers: [
          { label: "도입부가 너무 충격적이어서 홀린듯이 빠져들었어..", next: "result-aggro" },
          { label: "몰랐던 사실인데? 작가 정보력 뭐야..", next: "result-fastnews" }
        ]
      },
      "q2-1-1-2": {
        type: "question",
        id: "q2-1-1-2",
        text: "무대를 본 관객의 반응은?",
        answers: [
          { label: "다른 세계로 여행하고 온 기분이야", next: "result-fantasy" },
          { label: "과거로 잠시 갔다 온 느낌이야", next: "result-sliceoflife" }
        ]
      },
      "q2-2-1": {
        type: "question",
        id: "q2-2-1",
        text: "관객의 눈길을 끈 장면은?",
        answers: [
          { label: "로맨틱한 사랑 스토리", next: "q2-2-1-1" },
          { label: "남주에게 차인 여주의 맛깔스러운 먹방", next: "q2-2-1-2" }
        ]
      },
      "q2-2-1-1": {
        type: "question",
        id: "q2-2-1-1",
        text: "무대를 본 관객의 반응은?",
        answers: [
          { label: "나도 저런 사랑 하고싶다..", next: "result-dateblog" },
          { label: "저 캐릭터 너무 멋있다!", next: "result-datablog" }
        ]
      },
      "q2-2-1-2": {
        type: "question",
        id: "q2-2-1-2",
        text: "무대를 본 관객의 반응은?",
        answers: [
          { label: "되게 맛있게 먹네.. 오늘 저녁은 저걸로?", next: "result-toganjib" },
          { label: "슬픈 상황을 씩씩하게 이겨내는 주인공이 너무 기특해!", next: "result-toganjib" }
        ]
      },

      // === Q3: 무대 디자이너 ===
      "q3-1": {
        type: "question",
        id: "q3-1",
        text: "무대를 제작 중인 당신이 가장 먼저 준비하기 시작한 것은?",
        answers: [
          { label: "배우의 의상", next: "q3-1-1" },
          { label: "무대의 배경", next: "q3-1-1" }
        ]
      },
      "q3-1-1": {
        type: "question",
        id: "q3-1-1",
        text: "당신이 준비한 회심의 무대장치는?",
        answers: [
          { label: "극 전체의 메시지를 담은 나무 오브제", next: "q3-1-1-1" },
          { label: "극의 세부적인 요소를 표현하는 효과음", next: "q3-1-1-2" }
        ]
      },
      "q3-1-1-1": {
        type: "question",
        id: "q3-1-1-1",
        text: "관객의 반응이 더 좋았던 무대장치는?",
        answers: [
          { label: "알록달록 꽃이 핀 봄의 나무", next: "result-manggom" },
          { label: "고요한 흑백의 겨울 나무", next: "result-ganadi" }
        ]
      },
      "q3-1-1-2": {
        type: "question",
        id: "q3-1-1-2",
        text: "무대를 본 관객의 반응은?",
        answers: [
          { label: "클라이막스에 폭발하는 장면에서 눈물이 나더라고ㅠㅠ", next: "result-mulleong" },
          { label: "전체적인 흐름이 공감되고 흡입력있더라!", next: "result-jakka" }
        ]
      },

      // === 결과 노드 ===
      "result-nyangnyong": { type: "result", id: "result-nyangnyong", title: "챌린지 스타형 틱톡커", text: "내 안의 관종끼 폭발!<br>매일 챌린지 영상 찍다보니<br><span class='highlight-text'>어느새 100만 팔로워 틱톡커</span>", image: "images/nyang.jpg" }, //냥녕뇽냥
      "result-jingyeok":   { type: "result", id: "result-jingyeok",   title: "100만뷰 제작기 릴스/쇼츠 크리에이터형", text: "요즘 이게 인기라며?<br>미친 트랜드 파악 능력으로<br><span class='highlight-text'>조회수 끌어모으는 릴스/쇼츠 크리에이터</span>", image: "images/jingyeok.jpg" },//진격거
      "result-ppang-ddok": { type: "result", id: "result-ppang-ddok", title: "1분이면 다 꼬시는 틱톡커형", text: "Just a 1 minute,<br>내 팬이 되는 시간!<br><span class='highlight-text'>짧은 영상에 강한 틱톡커</span>", image: "images/ppang.jpg" },//빵먹다살찐떡
      "result-leejini":    { type: "result", id: "result-leejini",    title: "심장 저격형 릴스/쇼츠 크리에이터", text: "너 이거 좋아하지?<br>심장 저격해서 26841번 반복시청하게 만드는<br><span class='highlight-text'>심장 저격 릴스/쇼츠 크리에이터</span>", image: "images/leejini.jpg" }, //이진이
      "result-seunghun":   { type: "result", id: "result-seunghun",   title: "미친 스타성의 릴스/쇼츠 크리에이터", text: "연예인 안하고 뭐해?<br>끼를 참지 못하고 팬들 끌어모으는<br><span class='highlight-text'>스타성 미친 릴스/쇼츠 크리에이터</span>", image: "images/seunghun.jpg" }, //승헌쓰
      "result-leoj":       { type: "result", id: "result-leoj",       title: "에겐이 사랑하는 릴스/쇼츠 크리에이터형", text: "'언니 립 뭐에요?'<br>발끝까지 따라하고 싶게 만드는<br><span class='highlight-text'>워너비형 릴스/쇼츠 크리에이터</span>", image: "images/leoj.jpg" },//레오제이
      "result-malwang":    { type: "result", id: "result-malwang",    title: "테토가 사랑하는 릴스/쇼츠 크리에이터", text: "넘치는 테스토스테론으로<br>남자들 안기고 싶게 만드는<br><span class='highlight-text'>테토남 릴스/쇼츠 크리에이터</span>", image: "images/malwang.jpg" },//말왕
      "result-shuka":      { type: "result", id: "result-shuka",      title: "지상파 파급력의 정보 유튜버", text: "KBS, MBC, SBS 왜 봐?<br>나한텐 이게 뉴스고 신문이고 속보다<br><span class='highlight-text'>미친 PT 능력의 정보 유튜버</span>", image: "images/shuka.jpg" }, //슈카
      "result-itsub":      { type: "result", id: "result-itsub",      title: "믿습니다. 아멘. 정보 유튜버", text: "묻고 따질 필요없이<br>이 사람 추천이면 따라 산다<br><span class='highlight-text'>이 분야 탑티어 정보 유튜버</span>", image: "images/itsub.jpg" },//잇섭
      "result-ujuhama":    { type: "result", id: "result-ujuhama",    title: "몸빵형 게임 리뷰 유튜버", text: "내가 캐리한다<br>너는 즐겁게 시청하기나 해!<br><span class='highlight-text'>대리 성취형 게임 리뷰 유튜버</span>", image: "images/ujuhama.jpg" },//우주하마
      "result-deokyang":   { type: "result", id: "result-deokyang",   title: "당당한 오타쿠형 리뷰 유튜버", text: "당당하게 덕질하다보니<br>어느새 덕후 친구 100만명<br><span class='highlight-text'>당당한 오타쿠형 게임 리뷰 유튜버</span>", image: "images/deokyang.jpg" },//덕양소
      "result-chimchak":   { type: "result", id: "result-chimchak",   title: "킹받지만 매력있는 토크형 유튜버", text: "또 뻘소리하네ㅋㅋ 쟤를 누가 좋아하냐?<br>알고보면 사실 모두가 좋아하는<br><span class='highlight-text'>매력킹 토크 유튜버</span>", image: "images/chimchak.jpg" },//침착맨
      "result-mimiminu":   { type: "result", id: "result-mimiminu",   title: "말 많은 예능형 전문가 유튜버", text: "예능인이야 전문가야?<br>웃기지만 알고보면 이 분야 전문가<br><span class='highlight-text'>특정 분야 전문 토크형 유튜버</span>", image: "images/mimiminu.jpg" },//미미미누
      "result-hongka":     { type: "result", id: "result-hongka",     title: "뚫어뻥 운동가형 전문가 유튜버", text: "헉! 소리 나오는 예민한 문제도<br>나서서 시원하게 뚫어주는<br><span class='highlight-text'>이 시대의 사이다 토크형 유튜버</span>", image: "images/hongka.jpg" },//홍카콜라
      "result-gwedo":      { type: "result", id: "result-gwedo",      title: "지평좌표계형 전문가 유튜버", text: "평범한 주제를 새롭게 정의한다!<br>관심없던 얘기도 10시간 듣게되는 <br><span class='highlight-text'>마성의 전문가 토크형 유튜버</span>", image: "images/gwedo.jpg" },//궤도
      "result-gwak":       { type: "result", id: "result-gwak",       title: "너드 모험가형 브이로그 유튜버", text: "아니 저런거까지 시도한다고?<br>시작은 궁금증이지만 결국 응원하게되는<br><span class='highlight-text'>모험가형 유튜버</span>", image: "images/gwak.jpg" },//곽튜브
      "result-mongsun":    { type: "result", id: "result-mongsun",    title: "4차원형 일상 브이로그 유튜버", text: "보고 있으면 뇌정지 씨게 오지만<br>중독되면 다른 삼삼한 일상은 재미없어<br><span class='highlight-text'>미친 4차원 브이로그 유튜버</span>", image: "images/mongsun.jpg" },//몽순임당
      "result-ppangppang": { type: "result", id: "result-ppangppang", title: "뇌속이 궁금한 창작 유튜버", text: "작가 뇌 속이 너무 궁금하다<br>라는 댓글 10만개 달리는<br><span class='highlight-text'>4차원 일상 창작 유튜버</span>", image: "images/ppangppang.jpg" },//빵빵이
      "result-chongmyeot": { type: "result", id: "result-chongmyeot", title: "F감성 끄집어내는 창작 유튜버", text: "공감되서 울다가 웃다가<br>퇴근길에도 밥먹을 때도 보게 만드는<br><span class='highlight-text'>공감 일상 창작 유튜버</span>", image: "images/chongmyeot.jpg" },//총몇명
      "result-looks":      { type: "result", id: "result-looks",      title: "레슨 선생님형 유튜버", text: "내가 트랜드세터. 유행을 선두하는<br>세번째 레슨까지만 알려주는 밀당 매력의<br><span class='highlight-text'>트랜드앞잡이 유튜버</span>", image: "images/looks.jpg" },//룩삼
      "result-enjoy":      { type: "result", id: "result-enjoy",      title: "장기연애형 콩트 유튜버", text: "사람들이 좋아하는 컨텐츠만 쏙쏙 뽑아<br>올리기만 하면 100만 조회수 달성하는<br><span class='highlight-text'>장기연애 하고싶은 케미의 유튜버</span>", image: "images/short.jpg" },//숏박스
      "result-aggro":      { type: "result", id: "result-aggro",      title: "어그로 카드뉴스형 인스타 크리에이터", text: "너 이 제목 보고 클릭 안할 수 있어?<br>어그로에 끌렸지만 읽어보니 내용도 알차지?<br><span class='highlight-text'>구독하게 만드는 카드뉴스형 인스타 크리에이터</span>", image: "images/fastnews.jpg" },//카드뉴스(어그로)
      "result-fastnews":   { type: "result", id: "result-fastnews",   title: "긴급속보 카드뉴스형 인스타 크리에이터", text: "뉴스 볼 필요가 없다<br>팔로우하면 최신 뉴스 팔로업 완료!<br><span class='highlight-text'>속보 카드뉴스형 인스타 크리에이터</span>", image: "images/fastnews.jpg" },//카드뉴스(속보)
      "result-fantasy":    { type: "result", id: "result-fantasy",    title: "판타지형 브런치 작가", text: "가둬놓고 글만 쓰게 만들고 싶은<br>미친 상상력과 필력을 자랑하는<br><span class='highlight-text'>판타지 브런치 작가</span>", image: "images/brunch.jpg" },//판타지 브런치
      "result-sliceoflife":{ type: "result", id: "result-sliceoflife", title: "일상물 브런치 작가", text: "작가님 몸보다 연재가 우선입니다<br>공감되는 일상물을 연재하는<br><span class='highlight-text'>일상물 브런치 작가</span>", image: "images/brunch.jpg" },//일상물 브런치
      "result-dateblog":   { type: "result", id: "result-dateblog",   title: "데이트 손민수 양성 블로거", text: "데이트 코스 좀 공유했을 뿐인데<br>이젠 협찬으로 데이트 비용 다 해결하는<br><span class='highlight-text'>데이트 손민수 양성하는 블로거</span>", image: "images/blog.jpg" },//데이트 블로거
      "result-datablog":   { type: "result", id: "result-datablog",   title: "데이트 손민수 양성 블로거", text: "데이트 코스 좀 공유했을 뿐인데<br>이젠 협찬으로 데이트 비용 다 해결하는<br><span class='highlight-text'>데이트 손민수 양성하는 블로거</span>", image: "images/blog.jpg" },//데이트 블로거
      "result-toganjib":   { type: "result", id: "result-toganjib",   title: "먹천재 또간집형 블로거", text: "맛집 리스트 좀 공유했을 뿐인데<br>이젠 협찬으로 식비 다 해결하는<br><span class='highlight-text'>먹천재형 맛집 블로거</span>", image: "images/blog.jpg" },//맛집 블로거
      "result-manggom":    { type: "result", id: "result-manggom",    title: "양지 감성 인스타툰 작가", text: "귀여워! 재밌어! 사랑해!<br>응원하게 되는 캐릭터의<br><span class='highlight-text'>산뜻한 일상 인스타툰 작가</span>", image: "images/manggom.jpg" },//망곰이
      "result-ganadi":     { type: "result", id: "result-ganadi",     title: "음지 감성 인스타툰 작가", text: "배꼽 때 냄새 맡는 것 같지만<br>내 속의 음침한 면이랑 비슷해 공감되는<br><span class='highlight-text'>트위터 감성 인스타툰 작가</span>", image: "images/ganadi.jpg" },//가나디
      "result-mulleong":   { type: "result", id: "result-mulleong",   title: "미친 사연 인스타툰 작가", text: "헉 저런 일을 겪으셨다니..<br>특별한 사연을 응원하게 되는<br><span class='highlight-text'>인생 하이라이트 썰 인스타툰 작가</span>", image: "images/mulleong.jpg" },//물렁이
      "result-jakka":      { type: "result", id: "result-jakka",      title: "일상 공감 인스타툰 작가", text: "ㅋㅋㅋ맞아 나도 저랬어<br>공감되는 일상을 응원하게 되는<br><span class='highlight-text'>일상 공감 인스타툰 작가</span>", image: "images/jakka.jpg" }//자까
    };

    const historyStack = [];
    const START_NODE = "cover";

    const questionScreen = document.getElementById('screen-question');
    const resultScreen   = document.getElementById('screen-result');
    const questionTextEl = document.getElementById('questionText');
    const answersEl      = document.getElementById('answers');
    const backBtn        = document.getElementById('backBtn');
    const restartBtn     = document.getElementById('restartBtn');
    const progressBar    = document.getElementById('progressBar');
    const progressText   = document.getElementById('progressText');
    const resultTitleEl  = document.getElementById('resultTitle');
    const resultTextEl   = document.getElementById('resultText');
    const resultImageEl  = document.getElementById('resultImage');

    // 결과 버튼/모달
    const shareBtn       = document.getElementById('shareBtn');
    const moreBtn        = document.getElementById('moreBtn');
    const shareModal     = document.getElementById('shareModal');
    
    function isResultNode(node) { return node && node.type === 'result'; }
    function getNode(id) { return NODES[id]; }
    function currentNodeId() { return historyStack[historyStack.length - 1]; }

    function setScreen(mode, nodeType) {
      if (mode === 'question') {
        questionScreen.classList.remove('hidden');
        resultScreen.classList.add('hidden');
      } else if (mode === 'result') {
        questionScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');
      }
      const progressWrap = document.querySelector('.progress-wrap');
      if (nodeType === 'question' || nodeType === 'result') {
        progressWrap.style.display = 'block';
      } else {
        progressWrap.style.display = 'none';
      }
    }

    function updateProgress() {
      const TOTAL_STEPS = 5; // 질문 4 + 결과 1
      let questionCount = historyStack.filter(id => NODES[id]?.type === 'question').length;
      // 결과 도달 여부
      let resultCount   = historyStack.filter(id => NODES[id]?.type === 'result').length;
  
      let step = questionCount + resultCount;
      const pct = Math.round((step / TOTAL_STEPS) * 100);

      progressBar.style.width = pct + '%';
      progressText.textContent = `진행도 ${pct}%`;
    }

    function renderQuestion(node) {
        // intro 같은 다른 화면들 다 숨기기
    document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));

    questionTextEl.textContent = node.text;
    answersEl.innerHTML = '';
    node.answers.forEach(ans => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = ans.label;
        btn.setAttribute('data-next', ans.next);
        btn.addEventListener('click', () => goNext(ans.next));
        answersEl.appendChild(btn);
    });

    questionScreen.classList.remove('hidden');
    setScreen('question', node.type);
    updateProgress();
    backBtn.disabled = historyStack.length <= 1;
}


    function renderResult(node) {
      resultTitleEl.textContent = node.title || '결과';
      resultTextEl.innerHTML  = node.text || '';
      if (node.image) {
        resultImageEl.src = node.image;
        resultImageEl.alt = node.title || '결과 이미지';
        resultImageEl.classList.remove('hidden');
      } else {
        resultImageEl.classList.add('hidden');
      }
      setScreen('result', node.type);
      updateProgress();
    }

    function showScreen(id) {
    // 모든 화면 숨기기
    document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
    // 해당 화면만 보이기
    document.getElementById('screen-' + id).classList.remove('hidden');

    // 진행도 숨김/표시 제어
    const progressWrap = document.querySelector('.progress-wrap');
    if (id === 'cover' || id === 'intro') {
        progressWrap.style.display = 'none';
    } else {
        progressWrap.style.display = 'block';
    }
}

    function goNext(nextId) {
      const next = getNode(nextId);
      if (!next) {
        alert(`정의되지 않은 노드: ${nextId}`);
        return;
      }
      historyStack.push(nextId);
      if (isResultNode(next)) {
        renderResult(next);
      } else if (next.type === 'question') {
        renderQuestion(next);
      } else if (next.type === 'screen') {
        showScreen(nextId);
      }
      location.hash = '#' + nextId;
    }

    function goBack() {
      if (historyStack.length <= 1) return;
      historyStack.pop();
      const node = getNode(currentNodeId());
      if (isResultNode(node)) renderResult(node);
      else if (node.type === 'question') renderQuestion(node);
      else if (node.type === 'screen') showScreen(node.id);
      location.hash = '#' + currentNodeId();
    }

    function restart() {
      historyStack.splice(0, historyStack.length, START_NODE);
      showScreen(START_NODE);
      location.hash = '#' + START_NODE;
    }

    backBtn.addEventListener('click', goBack);
    restartBtn.addEventListener('click', restart);
   
    // Kakao SDK 초기화 (APP KEY 교체)
  if (window.Kakao && !Kakao.isInitialized()) {
   Kakao.init('b6f05073f481a68ec268e2391c5b473c'); // 예: Kakao.init('abc123...');
  }

  function getShareData() {
    const title = resultTitleEl.textContent.trim() || '내 크리에이터 유형';
    const desc  = resultTextEl.textContent.replace(/\s+/g,' ').trim().slice(0,80) + '...';
    const image = resultImageEl?.src || (location.origin + '/images/cover.png');
    const url   = location.origin + location.pathname; // 해시 제거, 시작 화면로 안내
    return { title, desc, image, url };
  }

  function openShareModal() { shareModal.classList.remove('hidden'); }
  function closeShareModal() { shareModal.classList.add('hidden'); }

  function shareToKakao() {
    const { title, desc, image, url } = getShareData();
    if (!window.Kakao) { alert('Kakao SDK 로드 실패'); return; }

    Kakao.Link.sendDefault({
      objectType: 'feed',
      content: {
        title: title,
        description: desc,
        imageUrl: image,   // 공개 URL이어야 미리보기 표시됨
        link: { mobileWebUrl: url, webUrl: url }
      },
      buttons: [
        { title: '나도 테스트하기', link: { mobileWebUrl: url, webUrl: url } }
     ]
    });
  }

  async function copyShareLink() {
    const shareUrl = location.href.split('#')[0];
    try {
      await navigator.clipboard.writeText(shareUrl);
      alert('링크가 복사되었습니다!');
    } catch {
      prompt('복사할 링크입니다. Ctrl/Cmd+C로 복사하세요:', shareUrl);
    }
  }

  // 모달 버튼 연결
  document.getElementById('kakaoShareBtn').addEventListener('click', shareToKakao);
  document.getElementById('instaShareBtn').addEventListener('click', () => {
    if (navigator.share) {
      navigator.share({
        title: '내 크리에이터 유형 테스트',
        text: '나도 테스트 해봤어! 👉',
        url: location.href.split('#')[0]
      }).catch(()=>{ /* 사용자가 취소 */ });
    } else {
      copyShareLink();
    }
  });
  document.getElementById('linkCopyBtn').addEventListener('click', copyShareLink);
  document.getElementById('shareCloseBtn').addEventListener('click', closeShareModal);

  // 결과 화면의 두 버튼 연결
  shareBtn.addEventListener('click', openShareModal);
  moreBtn.addEventListener('click', openDownloadModal);

  const downloadModal = document.getElementById('downloadModal');
  const downloadCloseBtn = document.getElementById('downloadCloseBtn');

  function openDownloadModal() {
    downloadModal.classList.remove('hidden');
  }
  function closeDownloadModal() {
    downloadModal.classList.add('hidden');
  }

  downloadCloseBtn.addEventListener('click', closeDownloadModal);

    function boot() {
      const hashId = location.hash?.replace('#','');
      const startId = getNode(hashId) ? hashId : START_NODE;
      historyStack.push(startId);
      const node = getNode(startId);
      if (isResultNode(node)) renderResult(node);
      else if (node.type === 'question') renderQuestion(node);
      else if (node.type === 'screen') showScreen(node.id);
    }

    boot();
  </script>
</body>
</html>
